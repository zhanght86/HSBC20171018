querysqldes1=select c.SendOutCom, c.ReceiveCom, c.certifycode,(select certifyname from lmcertifydes where certifycode = c.certifycode) certifyname,to_char((select certifyprice from lmcertifydes where certifycode = c.certifycode), ''FM999999999999990.0099'') certifyprice,round(sum(c.sumcount)),(case when sum(c.sumcount)*(select certifyprice from lmcertifydes where certifycode = c.certifycode) is null then 0.00 else sum(c.sumcount)*(select certifyprice from lmcertifydes where certifycode = c.certifycode) end),concat('''',{0}),concat('''',{1}) from (select a.SendOutCom, a.ReceiveCom, a.certifycode, a.sumcount from lzcardtrack a where 1=1 and a.stateflag in (''2'',''3'') {2} {3} {4} {5} union all  select a.SendOutCom, a.ReceiveCom, a.certifycode, a.sumcount from lzcardtrack a where a.stateflag=''1'' and a.operateflag=''0'' and not exists(select distinct 1 from lzcardtrack d where d.certifycode=a.certifycode and d.startno=a.startno and d.endno=a.endno and d.sendoutcom=a.sendoutcom and d.receivecom=a.receivecom and d.stateflag=''2'') {6} {7} {8} {9} union all select b.SendOutCom, b.ReceiveCom, b.certifycode, -b.sumcount  from lzcardtrack b where 1=1 and b.stateflag in (''2'',''3'') {10} {11} {12} {13} union all select b.SendOutCom, b.ReceiveCom, b.certifycode, -b.sumcount from lzcardtrack b where b.stateflag=''1'' and b.operateflag=''0'' and not exists(select distinct 1 from lzcardtrack d where d.certifycode=b.certifycode and d.startno=b.startno and d.endno=b.endno and d.sendoutcom=b.sendoutcom and d.receivecom=b.receivecom and d.stateflag=''2'') {14} {15} {16} {17} ) c group by SendOutCom, ReceiveCom, certifycode union all select ''\u91d1\u989d\u5408\u8ba1'','''','''','''','''',0, (case when sum(c.money) is null then 0 else sum(c.money) end),concat('''',{18}),concat('''',{19}) from (select a.sumcount*(select certifyprice from lmcertifydes where certifycode = a.certifycode) money from lzcardtrack a where 1 = 1 and a.stateflag in (''2'',''3'') {20} {21} {22} {23} union all select a.sumcount*(select certifyprice from lmcertifydes where certifycode = a.certifycode) money from lzcardtrack a where a.stateflag=''1'' and a.operateflag=''0'' and not exists(select distinct 1 from lzcardtrack d where d.certifycode=a.certifycode and d.startno=a.startno and d.endno=a.endno and d.sendoutcom=a.sendoutcom and d.receivecom=a.receivecom and d.stateflag=''2'') {24} {25} {26} {27} union all select -b.sumcount*(select certifyprice from lmcertifydes where certifycode = b.certifycode) money from lzcardtrack b  where 1 = 1 and b.stateflag in (''2'',''3'') {28} {29} {30} {31} union all select -b.sumcount*(select certifyprice from lmcertifydes where certifycode = b.certifycode) money from lzcardtrack b where b.stateflag=''1'' and b.operateflag=''0'' and not exists(select distinct 1 from lzcardtrack d where d.certifycode=b.certifycode and d.startno=b.startno and d.endno=b.endno and d.sendoutcom=b.sendoutcom and d.receivecom=b.receivecom and d.stateflag=''2'') {32} {33} {34} {35} ) c
querysqldes1_0= ''{0}''
querysqldes1_1= ''{0}''
querysqldes1_2= and a.SendOutCom=''{0}''
querysqldes1_3= and a.ReceiveCom>=''{0}''
querysqldes1_4= and a.makedate>=''{0}''
querysqldes1_5= and a.makedate<=''{0}''
querysqldes1_6= and a.SendOutCom=''{0}''
querysqldes1_7= and a.ReceiveCom>=''{0}''
querysqldes1_8= and a.makedate>=''{0}''
querysqldes1_9= and a.makedate<=''{0}''
querysqldes1_10= and b.SendOutCom=''{0}''
querysqldes1_11= and b.ReceiveCom>=''{0}''
querysqldes1_12= and b.makedate>=''{0}''
querysqldes1_13= and b.makedate<=''{0}''
querysqldes1_14= and b.SendOutCom=''{0}''
querysqldes1_15= and b.ReceiveCom>=''{0}''
querysqldes1_16= and b.makedate>=''{0}''
querysqldes1_17= and b.makedate<=''{0}''
querysqldes1_18= ''{0}''
querysqldes1_19= ''{0}''
querysqldes1_20= and a.SendOutCom=''{0}''
querysqldes1_21= and a.ReceiveCom>=''{0}''
querysqldes1_22= and a.makedate>=''{0}''
querysqldes1_23= and a.makedate<=''{0}''
querysqldes1_24= and a.SendOutCom=''{0}''
querysqldes1_25= and a.ReceiveCom>=''{0}''
querysqldes1_26= and a.makedate>=''{0}''
querysqldes1_27= and a.makedate<=''{0}''
querysqldes1_28= and b.SendOutCom=''{0}''
querysqldes1_29= and b.ReceiveCom>=''{0}''
querysqldes1_30= and b.makedate>=''{0}''
querysqldes1_31= and b.makedate<=''{0}''
querysqldes1_32= and b.SendOutCom=''{0}''
querysqldes1_33= and b.ReceiveCom>=''{0}''
querysqldes1_34= and b.makedate>=''{0}''
querysqldes1_35= and b.makedate<=''{0}''
