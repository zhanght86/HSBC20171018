#RIDataSearchInputSql1=select a.eventno,a.contno,(select codename from ldcode where code=eventtype and codetype=''rieventtype''),(case when a.feeoperationtype=''SX'' then ''\u5931\u6548'' when a.accumulatedefno=''L01010060010'' then (SELECT distinct duty.getdutyname FROM riaccumulategetduty duty WHERE a.dutycode=duty.getdutycode) when a.eventtype in (''01'',''02'') then ''\u4fdd\u8d39'' when a.eventtype in (''04'') then ''\u7406\u8d54\u6b3e'' when a.eventtype in (''03'') then (select edorname from lmedoritem where edorcode=a.feeoperationtype and appobj=''I'') end),a.riskcode,a.dutycode,a.insuredno,a.insuredname,(select codename from ldcode where code=a.Insuredsex and codetype=''sex''),a.currentage,(select codename from ldcode where code=a.smokeflag and codetype=''smoke''),a.OccupationType,a.cvalidate,a.insuredyear,(select codename from ldcode where code=a.GetStartType and codetype=''uwtype3''),a.plantype,(select codename from ldcode where code=(select getdutytype from riaccumulatedef riacc where riacc.accumulatedefno=a.accumulatedefno) and codetype=''riacctype''),RIContNo,RIPreceptNo,accumulatedefno,a.standprem,a.ExtPrem1,a.ExtRate1||''%'',a.ExtPrem2,a.ExtRate2,a.ExtPrem3,a.ExtRate3*100||''%'',riskamnt,a.Currency,decode(EventType,''03'',riskamnt-PRERISKAMNT,0),a.ChangeRate,a.ChRiskAmnt,a.accCurrency,(case when a.accamnt is null then 0 else a.accamnt end),decode(EventType,''04'',CLMGETMONEY,0),GetDate,a.makedate,(case when(a.getdate>=(select lockdate from RIBsnsBillLock l where l.accumulatedefno=a.accumulatedefno and l.serial=(select max(lb.serial) from RIBsnsBillLock lb where lb.accumulatedefno=l.accumulatedefno))) then ''\u5DF2\u9501\u5B9A'' else ''\u672A\u9501\u5B9A'' end) from ripolrecordbake a where 1=1 {0} {1} {2} {3} {4} and (a.BFFlag={5} or a.BFFlag is null) {6} {7} {8} and rownum <= 200  order by accumulatedefno,insuredno,GetDate,MakeDate
RIDataSearchInputSql1=select a.eventno,a.contno,getcodename(''rieventtype'',eventtype),(case when a.feeoperationtype=''SX'' then ''\u5931\u6548'' when a.feeoperationtype=''JYFX'' then ''\u7B80\u6613\u590D\u6548'' when a.accumulatedefno=''L01010060010'' then (SELECT distinct duty.getdutyname FROM riaccumulategetduty duty WHERE a.dutycode=duty.getdutycode) when a.eventtype in (''01'',''02'') then ''\u4fdd\u8d39'' when a.eventtype in (''04'') then ''\u7406\u8d54\u6b3e'' when a.eventtype in (''03'') then (select edorname from lmedoritem where edorcode=a.feeoperationtype and appobj=''I'') end),a.riskcode,a.dutycode,a.insuredno,(nvl((select x.Nameen from Lcinsured x where x.Contno=a.Contno and x.Insuredno=a.Insuredno),''NONAME'')),getcodename(''sex'',decode((select x.sex from Lcinsured x where x.Contno=a.Contno and x.Insuredno=a.Insuredno),'0','0','1')),(SELECT x1.insuredappage FROM lcpol x1 where x1.polno=a.polno)+ceil(months_between(date ''{9}'', a.cvalidate - 1) / 12)-1,getcodename(''smoke'',nvl((select x.Smokeflag from Lcinsured x where x.Contno=a.Contno and x.Insuredno=a.Insuredno),''N'')),(SELECT 1 FROM lcpol x1 where x1.polno=a.polno),a.cvalidate,ceil(months_between(date ''{9}'', a.cvalidate - 1) / 12),getcodename(''uwtype3'',a.GetStartType),a.plantype,getcodename(''riacctype'',(select getdutytype from riaccumulatedef riacc where riacc.accumulatedefno=a.accumulatedefno)),RIContNo,RIPreceptNo,accumulatedefno,decode((SELECT dd.standprem FROM lcduty dd where dd.polno=a.polno and dd.dutycode=a.dutycode),null,0,(SELECT dd.standprem FROM lcduty dd where dd.polno=a.polno and dd.dutycode=a.dutycode)),a.ExtPrem1,a.ExtRate1||''%'',a.ExtPrem2,a.ExtRate2,a.ExtPrem3,a.ExtRate3*100||''%'',riskamnt,a.currency,decode(EventType,''03'',riskamnt-PRERISKAMNT,0),a.ChangeRate,riskamnt*a.ChangeRate,a.accCurrency,(case when a.accamnt is null then 0 else a.accamnt end),decode(EventType,''04'',CLMGETMONEY,0),GetDate,{9},(case when(a.getdate>=(select lockdate from RIBsnsBillLock l where l.accumulatedefno=a.accumulatedefno and l.serial=(select max(lb.serial) from RIBsnsBillLock lb where lb.accumulatedefno=l.accumulatedefno))) then ''\u5DF2\u9501\u5B9A'' else ''\u672A\u9501\u5B9A'' end) from ripolrecordbake a where 1=1 {0} {1} {2} {3} {4} and (a.BFFlag={5} or a.BFFlag is null) {6} {7} {8} and rownum <= 200  order by accumulatedefno,insuredno,GetDate,MakeDate
RIDataSearchInputSql1_0=and a.accumulatedefno=''{0}''
RIDataSearchInputSql1_1=and a.RIContNo=''{0}''
RIDataSearchInputSql1_2=and a.InsuredNo=''{0}''
RIDataSearchInputSql1_3=and a.InsuredName like ''%{0}%''
RIDataSearchInputSql1_4=and a.EventType=''{0}''
RIDataSearchInputSql1_5=''{0}''
RIDataSearchInputSql1_6=and exists (select 1 from ribargaininfo b where a.ricontno=b.ricontno and b.conttype=''{0}'')
RIDataSearchInputSql1_7=and ((a.getdate>=''{0}'' and a.bfflag is  null) or ((SELECT t.startdate FROM riwflog t WHERE t.batchno=a.batchno and a.accumulatedefno=t.taskcode ) >=''{0}'' and a.bfflag is not null))
RIDataSearchInputSql1_8=and ((a.getdate<=''{0}'' and a.bfflag is  null) or ((SELECT m.enddate FROM riwflog m WHERE m.batchno=a.batchno and a.accumulatedefno=m.taskcode ) <=''{0}'' and a.bfflag is not null))
RIDataSearchInputSql1_9=''{0}''

RIDataSearchInputSql2=select a.ContNo,a.RiskCode, nvl(a.DutyCode,''''),a.incomecompanyno,(select ComPanyName from RIComInfo where ComPanyNo = incomecompanyno),a.AreaID,a.CessionRate,a.CessionAmount,a.Amountchang,(select b.ParamDouble1 from RICalParam b where a.Serialno = b.Serialno),nvl(PremChang,0),(case when a.ripreceptno <> ''C01010040020'' then ''\u4E0D\u9002\u7528'' else (case when (SELECT b.standbydouble1 FROM ripolrecordbake b WHERE b.eventno = a.eventno) = 1 then ''\u5DF2\u8D85\u51FA'' else ''\u672A\u8D85\u51FA'' end) end),(select b.ParamDouble2 from RICalParam b where a.Serialno = b.Serialno),nvl(CommChang,0),nvl((select sum(b.FeeMoney)from Ripolrecordbake b where b.Insuredyear = (select max(b.Insuredyear) from Ripolrecordbake c where b.Polno = c.Polno) and a.Eventno=b.Eventno and a.ContNo=b.ContNo and a.RiskCode=b.Riskcode), 0),nvl(CommChang,0)+nvl((select sum(b.FeeMoney)from Ripolrecordbake b where b.Insuredyear = (select max(b.Insuredyear) from Ripolrecordbake c where b.Polno = c.Polno) and a.Eventno=b.Eventno and a.ContNo=b.ContNo and a.RiskCode=b.Riskcode), 0),nvl(ReturnPay,0),a.RIDate,(case when(a.ridate>=(select lockdate from RIBsnsBillLock l where l.accumulatedefno=a.accumulatedefno and l.serial=(select max(lb.serial) from RIBsnsBillLock lb where lb.accumulatedefno=l.accumulatedefno))) then ''\u5DF2\u9501\u5B9A'' else ''\u672A\u9501\u5B9A'' end) from RIRecordTrace a where a.EventNo={0} order by AreaID
RIDataSearchInputSql2_0=''{0}''

RIDataSearchInputSql3=select a.ContNo,a.RiskCode, nvl(a.DutyCode,''''),a.incomecompanyno,(select ComPanyName from RIComInfo where ComPanyNo = incomecompanyno),a.AreaID,a.CessionRate,a.CessionAmount,a.Amountchang,(select b.ParamDouble1 from RICalParam b where a.Serialno = b.Serialno),nvl(PremChang,0),(select b.ParamDouble2 from RICalParam b where a.Serialno = b.Serialno),nvl(CommChang,0),nvl(a.Standbydouble2,0),nvl(a.Standbydouble3,0),nvl(a.Standbydouble4,0),nvl(CommChang,0)+nvl(a.Standbydouble2,0)+nvl(a.Standbydouble3,0)+nvl(a.Standbydouble4,0),nvl(ReturnPay,0),a.RIDate,(case when(a.ridate>=(select lockdate from RIBsnsBillLock l where l.accumulatedefno=a.accumulatedefno and l.serial=(select max(lb.serial) from RIBsnsBillLock lb where lb.accumulatedefno=l.accumulatedefno))) then ''\u5DF2\u9501\u5B9A'' else ''\u672A\u9501\u5B9A'' end) from RIRecordTrace a where a.EventNo={0} order by AreaID
RIDataSearchInputSql3_0=''{0}''
